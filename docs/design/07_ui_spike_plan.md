# 07. UIスパイク実施計画（A案確定）

## 1. 目的
ホームとセッション実行のUIをA案で確定し、「記録一覧をホームから分離する構成」を固定します。  
本ドキュメントは後工程の実装担当が迷わないための最終版です。

## 2. スコープ
- 対象画面: ホームA、記録一覧、セッションA
- 種別: UI専用（ダミーデータ、ロジックなし）
- コンポーネント基盤: `shadcn/ui`
- 状態アイコン: `@mynaui/icons-react`

## 3. プレビューURL（実装時ルート）
- Home A: `http://localhost:5181/ui-preview/home-a`
- History: `http://localhost:5181/ui-preview/history-list`
- Session A: `http://localhost:5181/ui-preview/session-a`
- Status Patterns: `http://localhost:5181/ui-preview/status-patterns`

## 4. 固定仕様サマリー
- Home A: 1日4スロット方式（未登録`+`→設定モーダル）で、日付見出し + 手技カード + 当日ノート表を1パネルに統合
- Home A: 手技開始通知は本アプリ対象外とし、外部アラーム運用注記を表示
- Session A: 警告帯固定に加え、`戻る/次へ/Enter` によるカルーセル遷移で「進んだこと」を視認
- History: CAPDノート準拠項目を一覧化し、写真はリンク遷移で確認

## 5. レイアウト固定ルール
- セッション画像は常に1:1正方形
- iPhoneは1カラム縦並び
- Macは2カラム（左: 画像、右: 操作）
- 記録一覧はホームに埋め込まず、独立画面で表示
- 記録一覧の写真はリンク遷移（`/ui-preview/history-photo/:photoId`）で確認
- Home Aは4スロット固定（#1〜#4）で、初期状態は全スロット未登録
- Home Aは「手技設定モーダル（CSV/推奨実施）」「手技の開始確認モーダル」「手技内容確認モーダル（閲覧のみ）」を持つ
- Home Aは「カード本体タップ=開始確認」、`•••` メニューで確認/編集を分離する
- Home Aのカード状態は `未実施` / `実施中` / `実施済み` の3種で、`実施中` は再開、`実施済み` は開始不可とする
- Home Aは中断履歴の専用バッジ（`前回中断あり`）を表示しない
- Home Aのスロット登録は推奨実施時間の厳密昇順（左<右）を必須とする
- Home Aの右側スロット開始は、左側スロットがすべて実施済みの場合のみ許可する
- Home Aの `実施済み` スロットは編集/削除不可。対象日に active セッションがある間は全スロット編集不可
- Home Aは本日のみCAPD記録ノート互換表を表示し、交換列は `#1〜#5` の5列固定
- 当日ノートの列マッピングは `record_exchange_no` / `timer_exchange_no` で決定
- 当日ノートの透析液濃度はCSVタイトル（例: `レギニュール1.5`）を表示
- 当日ノートの除水量は、交換#1=`未計算`、交換#2以降=`排液量 - 前回注液量`、総除水量=計算可能分合算で表示
- Session Aの状態表示は Compact Badge（MynaUI icon + 色）を採用
- Session Aのタイトルは `#通し番号 + タイトル` で表示
- Session Aの戻る/次へはiPhone/Macとも横並び同幅
- Session Aは左右ナビボタンを表示しない（ボタン遷移のみ）
- Session Aは右上 `•••` から `セッションを中断（非常用）` を実行可能。中断後はホームへ戻し、スロット表示を `未実施` に戻す

## 6. 実施確認手順
1. `/ui-preview/*` で4画面を確認
2. Home Aで `+` → 設定モーダル保存 → カード表示更新を確認
3. Home Aでカード本体タップ時に開始確認ダイアログが出ることを確認
4. Home Aで `•••` メニューから確認/編集が開き、開始誤発火しないことを確認
5. Home Aで当日ノート互換表が表示され、過去分が一覧画面へ分離されていることを確認
6. 当日ノート/記録一覧で `record_exchange_no` / `timer_exchange_no` の列マッピングを確認
7. 記録一覧でCAPDノート準拠項目と総除水量(自動)表示を確認
8. Session Aで `戻る/次へ/Enter` によるカルーセル遷移を確認
9. Session Aで `#通し番号` 表示と状態バッジ配色を確認

## 7. 次の1修正ポイント
- UIスパイクは一旦完了。実装フェーズで実運用データに合わせた微調整のみ実施します。
