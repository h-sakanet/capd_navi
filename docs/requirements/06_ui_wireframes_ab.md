# 06. UIワイヤーフレーム（A案確定）

## 1. 目的
実装前にUI仕様を固定し、画面解釈のズレを抑えるためにホーム/セッションのA案を確定します。  
ホームは「手技開始ハブ + 当日CAPDノート表示」に限定し、過去記録は別画面へ分離します。

## 2. スパイク前提
- UI専用（ダミーデータ、API/DB更新なし）
- 実装コンポーネント基盤は `shadcn/ui`
- 対象はホームA/セッションA/記録一覧（構成確認）

## 3. 対象画面
- ホーム（手技テンプレート選択、当日ノート、記録一覧導線）
- 記録一覧（履歴表示/編集導線）
- セッション実行

## 4. 共通遷移
```mermaid
flowchart LR
  H[ホーム] --> S[セッション開始]
  H --> L[記録一覧]
  L --> E[記録編集]
  E --> L
  S --> P[ステップ進行]
  P --> H
```

## 5. ホームA（確定）
```text
+------------------------------------------------+
| 02/10 (火)                                      |
| 手技開始通知は外部アラーム運用（時計アプリ等）   |
+------------------------------------------------+
| [ + ] [ + ] [ + ] [ + ]                         |
+------------------------------------------------+
| #1 登録後                                  [•••]|
| レギニュール1.5                                  |
| ステータス：未実施 / 実施中 / 実施済み          |
| 推奨実施 20:00                                  |
| （カード本体タップで開始/再開ダイアログを表示）  |
+------------------------------------------------+
| 交換列 | #1 | #2 | #3 | #4 | #5                 |
| 貯留時間(timer:dwell start-end)                  |
| 透析液濃度(CSVタイトル: レギニュール1.5)         |
| 排液量(record:drain_weight_g)                    |
| 注液量(record:bag_weight_g)                      |
| 除水量(自動) / 排液時間(timer:drain start-end)   |
| 排液の確認(record:drain_appearance)              |
| 1日の総除水量(自動), 尿量, 飲水量, 体重, 排便,    |
| 血圧, 出口部状態, 出口部写真(記録写真), 備考       |
+------------------------------------------------+
| [CSV取り込み(Mac)]                              |
| [記録一覧を開く]                                |
+------------------------------------------------+
```
- スロット登録時は、左から右へ推奨実施時間が厳密昇順（同時刻不可）になるように検証します。
- 右側スロットを開始するには、左側スロットがすべて `実施済み` である必要があります。
- `実施済み` スロットは編集/削除できません。対象日に進行中セッションがある間はスロット編集を行えません。
- `実施中` スロットは本体タップで進行中セッションを再開します（新規開始しません）。
- `••• > 確認` からの手順表示は確認モードとし、記録・タイマー・通知・状態更新の副作用を持たせません。
- ホーム全体サマリの `出口部写真` 操作は、当日 `summaryScope=both` または `summaryScope=first_of_day` の `session_summary` 入力完了後に表示します。
- 対象レコード選択は `both` 優先、次に `first_of_day`、同値時は `completedAt` 昇順、さらに同値時は `recordId` 昇順の決定論で固定します。
- iPhoneは `出口部写真` の `登録/変更/削除` を表示し、Macは閲覧リンクのみ表示します。

### 5.1 ホームA 手技設定モーダル
```text
+-----------------------------------------------+
| #1 手技設定                                   |
| CSV選択: [レギニュール1.5 v]                  |
| 推奨実施時間: [20:00]                           |
|                          [キャンセル] [保存]   |
+-----------------------------------------------+
```

### 5.2 ホームA 手技開始確認モーダル
```text
+-----------------------------------------------+
| 手技の開始                                     |
| 手技: レギニュール1.5                          |
| ステータス：未実施 or 実施中                   |
| 推奨実施: 20:00                                |
|                        [閉じる] [開始/再開]    |
+-----------------------------------------------+
```

### 5.3 ホームA 手技内容確認モーダル（閲覧専用）
```text
+-----------------------------------------------+
| 手技内容の確認                                 |
| 手技: レギニュール1.5                          |
| ステータス：未実施                             |
| 推奨実施: 20:00                                |
| ※この導線は手順閲覧専用（確認モード）。記録保存/タイマー開始/通知生成/状態更新は行わない |
|                 [閉じる] [手順を表示（保存なし）]|
+-----------------------------------------------+
```

### 5.4 ホームA 右上メニュー（•••）
```text
+-----------------------------------------------+
| [確認]                                         |
| [編集]                                         |
+-----------------------------------------------+
```

### 5.5 ホームA 全体サマリ内の出口部写真操作（iPhone）
```text
+-----------------------------------------------+
| 出口部写真（記録写真）                          |
| 未登録: [登録]                                  |
| 登録済み: [変更] [削除]                         |
+-----------------------------------------------+
```
- 入力手段は `カメラ撮影` と `ファイル選択` を提供します。
- 削除時は `未登録` へ戻ります。
- 保存は `payload.exit_site_photo` への部分パッチとして同期されます。

## 6. 記録一覧（共通構成）
```text
+------------------------------------------------+
| 記録一覧                                         |
| 期間: [直近30日 v]  [検索]                      |
+------------------------------------------------+
| 日付 | 透析液濃度(#1-#5) | 貯留時間(#1-#5) | 排液量(#1-#5) |
| 注液量(#1-#5) | 排液時間(#1-#5) | 排液確認(#1-#5)        |
| 除水量(#1は未計算、#2以降は排液量-前回注液量)     |
| 総除水量(自動) | 尿量/飲水量 | 体重 | 血圧 | 排液写真 | 出口部写真 |
| 2026-02-09 | レギニュール1.5 | ... | ... | ... | ...    |
+------------------------------------------------+
| [ホームへ戻る]                                   |
+------------------------------------------------+
```

### 6.1 記録詳細（対象 `session_summary`）の出口部写真操作
- iPhone記録詳細にもホーム全体サマリと同じ `登録/変更/削除` 行を表示します。
- Mac記録詳細は写真閲覧のみ許可し、更新操作は表示しません。
- ホーム導線と記録詳細導線は同一レコード状態を参照し、表示を一致させます。

## 7. セッションA（レスポンシブ確定）

### 7.1 共通レイアウト規則
- 画像表示領域は常に 1:1 正方形
- iPhone: 1カラム（画像→手順→チェック/アラーム）
- Mac: 2カラム（左: 正方形画像、右: 手順/チェック/操作）

### 7.2 セッションA（安全フォーカス）
```text
+------------------------------------------------+
| フェーズ: 廃液 / 状態: お腹→廃液バッグ           |
+----------------------+-------------------------+
| [正方形画像]          | #21 タイトル/表示テキスト |
|                      | ! 警告帯(固定表示)       |
|                      | 必須チェック              |
|                      | ! 待機アラーム            |
|                      | [••• > セッションを中断（非常用）] |
|                      | [戻る] [次へ（条件未達で無効）] |
+----------------------+-------------------------+
```
- 次へ/戻る押下（またはEnterで次へ）時に、メインパネルは左右スライドで遷移します。
- カルーセルの左右ナビゲーションボタンは表示しません。
- 状態表示は `Compact Badge`（MynaUI icon + 色）で表示します。
- 「戻る」「次へ」は iPhone/Mac ともに横並び同幅で表示します。
- セッション中断は右上 `•••` からのみ実行し、確認ダイアログを挟みます。

## 8. UIプレビュールート
- `/ui-preview/home-a`
- `/ui-preview/history-list`
- `/ui-preview/session-a`
- `/ui-preview/status-patterns`

## 9. 採用基準（5段階）
- 安全性視認
- 次操作明確性
- 片手操作可読性
- 情報過不足
- 疲労感

## 10. 次の1修正ポイント
- UIスパイクの主要調整は完了。実装フェーズで実データ連携時の微調整のみ実施します。
