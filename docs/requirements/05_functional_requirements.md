# 05. 機能要件

## 1. ホーム機能
- FR-001: 複数手技テンプレート一覧を表示します。
- FR-002: テンプレートごとに名称、版、有効開始日を表示します。
- FR-003: 選択した1手技でセッションを開始します。
- FR-004: 1日1回の全体リマインド設定を提供します。

## 2. CSV取り込み機能
- FR-010: ユーザーがCSVファイルを指定して取り込みできます。
- FR-011: CSV v3フォーマットのみ受け付けます。
- FR-012: 検証エラー1件以上で取り込みを中止します。
- FR-013: 警告は取り込み結果画面で一覧表示します。
- FR-014: 画像相対パスをCSVディレクトリ基準で解決します。

## 3. セッション進行機能
- FR-020: 現在ステップのフェーズと状態を常時表示します。
- FR-021: 必須チェック未完了時に次ステップ遷移を禁止します。
- FR-022: `record_event` 未完了時に次ステップ遷移を禁止します。
- FR-023: `next_step_id` に従い完全シリアルで遷移します。
- FR-024: 最終ステップ完了時にセッション完了状態へ遷移します。

## 4. 記録機能
- FR-030: `drain_appearance` 入力モーダルを提供します。
- FR-031: 見た目分類は `透明/やや混濁/混濁/血性/その他` を提供します。
- FR-032: 廃液写真は常に任意入力です。
- FR-033: `drain_weight_g` と `bag_weight_g` を g単位で保存します。
- FR-034: `session_summary` で以下を収集します。
  - 必須: 血圧上、血圧下、脈拍、体重、体温、尿量、排便回数
  - 任意: 症状メモ、備考

## 5. タイマー/アラーム機能
- FR-040: `timer_event=start/end` をステップ到達時に自動記録します。
- FR-041: `alarm_trigger=step_enter` で通知を1回送信します。
- FR-042: 再通知は行いません。

## 6. 異常判定機能
- FR-050: 見た目分類ベースの簡易判定を行います。
- FR-051: 異常時は警告表示のみ行います。
- FR-052: 連絡ボタン等の導線はv1対象外とします。

## 7. 版管理機能
- FR-060: 新版取り込み後、テンプレート版として保存します。
- FR-061: セッション開始時に版スナップショットを保存します。
- FR-062: セッション表示時はスナップショットを優先します。

## 8. セキュリティ/接続要件
- FR-070: アプリ独自の起動認証は行いません。
- FR-071: オンライン接続を必須とします。
- FR-072: 記録データの正本はクラウド保存とします。

## 9. 非機能要件
- NFR-001: CSV取り込み結果はエラー/警告箇所を特定できること。
- NFR-002: セッション再開時に最後の進行位置を復元できること。
- NFR-003: 画面文言は日本語で統一すること。
